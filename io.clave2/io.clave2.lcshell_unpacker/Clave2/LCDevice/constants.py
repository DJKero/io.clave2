# Constants and Important Values
PACKET_DEBUG = True
SENSELOCK_VENDOR_ID = 0x1BC0
LC_PRODUCT_ID = 0x8101

API_BASE_EXCHANGE_KEY = b"\x70\x25\x4E\x4D\x73\xF5\x89\xFD\xF0\xAC\x4E\xD3\x52\x94\x14\x67"
PACKET_SIZE = 0x45
# Operation Constants
OP_AUTHENTICATE = 0x00
OP_CHANGE_PASSWD = 0x01
OP_HW_INFO = 0x02
OP_READ = 0x03
OP_WRITE = 0x04
OP_CLEAR = 0x05
OP_INIT_SYSTEM = 0x06
OP_INIT_MEM = 0x07
OP_CONVERT = 0x08
OP_SIGN = 0x09
OP_UPDATE = 0x0A
OP_SESSION = 0x0B

# Operation Mode Constants
OP_AUTHENTICATE_MODE_LOGIN_ADMIN = 0x00
OP_AUTHENTICATE_MODE_LOGIN_USER = 0x01
OP_AUTHENTICATE_MODE_LOGIN_AUTH = 0x02
OP_AUTHENTICATE_MODE_LOGOUT = 0x03

OP_CONVERT_MODE_ENCRYPT = 0x00
OP_CONVERT_MODE_DECRYPT = 0x01

OP_SIGN_MODE_INIT = 0x00
OP_SIGN_MODE_UPDATE = 0x01
OP_SIGN_MODE_FINALIZE = 0x02

OP_UPDATE_MODE_SET_BLOCK = 0x00
OP_UPDATE_MODE_WRITE_BLOCK = 0x01
OP_UPDATE_MODE_VALIDATE_HEADER = 0x02
OP_UPDATE_MODE_VALIDATE_SIGNATURE = 0x03

OP_SESSION_MODE_SET_EXCHANGE_KEY = 0xCD

# Error Codes
LC_SUCCESS = 0x00
LC_OPEN_DEVICE_FAILED = 0x01
LC_FIND_DEVICE_FAILED = 0x02
LC_INVALID_PARAMETER = 0x03
LC_INVALID_BLOCK_NUMBER = 0x04
LC_HARDWARE_COMMUNICATE_ERROR = 0x05
LC_INVALID_PASSWORD = 0x06
LC_ACCESS_DENIED = 0x07
LC_ALREADY_OPENED = 0x08
LC_ALLOCATE_MEMORY_FAILED = 0x09
LC_INVALID_UPDATE_PACKAGE = 0x0A
LC_SYN_ERROR = 0x0B
LC_OTHER_ERROR = 0x0C

DONGLE_ERROR_MAP = {
    0:0,
    3:3,
    7:7,
    9:6,
    10:5,
    11:1,
    12:2,
    13:8,
    14:11,
}


BANK_MAP = {
    0: [0x0000,512],
    1: [0x0200, 512],
    2: [0x0400, 512],
    3: [0x0600, 384]
}

USER_TYPE_ADMIN = 0
USER_TYPE_USER = 1
USER_TYPE_AUTH = 2

# Secret Offsets
UNK_SECRET_1_OFFSET = 0x780
UNK_SECRET_1_SIZE = 0x18
HMAC_KEY_OFFSET = 0x798
HMAC_KEY_SIZE = 0x14
UPDATE_KEY_OFFSET = 0x7AC
UPDATE_KEY_SIZE = 0x14
UNK_SECRET_2_OFFSET = 0x7C0
UNK_SECRET_2_SIZE = 0x10
UNK_SECRET_3_OFFSET = 0x7D0
UNK_SECRET_3_SIZE = 0x10
ADMIN_PASS_OFFSET = 0x7E0
ADMIN_PASS_SIZE = 0x0A
USER_PASS_OFFSET = 0x7EA
USER_PASS_SIZE = 0x0A
AUTH_PASS_OFFSET = 0x7F4
AUTH_PASS_SIZE = 0x0A
UNK_SECRET_4_OFFSET = 0x7FE
UNK_SECRET_4_SIZE = 0x02

SECRET_COMMIT_OFFSET = 0x600
KEY_MEMORY_OFFSET_END = 0x7FF
SECRET_BASE_OFFSET = 0x700
AUTH_WRITE_MAP_OFFSET = 0x200
UPDATE_SECURE_WRITE_OFFSET = 0x800
USER_SECRET_MAP = {
    USER_TYPE_ADMIN:{'offset':ADMIN_PASS_OFFSET,'final_offset':USER_PASS_OFFSET,'final_size':0x15},
    USER_TYPE_USER:{'offset':USER_PASS_OFFSET,'final_offset':AUTH_PASS_OFFSET,'final_size':0x0B},
    USER_TYPE_AUTH:{'offset':AUTH_PASS_OFFSET,'final_offset':UNK_SECRET_4_OFFSET,'final_size':0x01}
}
